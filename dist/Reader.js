import{unzipSync as e}from"node:zlib";import{BufferConsumer as t}from"@triforce-heroes/triforce-core/BufferConsumer";export function getEntries(r,n){let a=[],i=new t(n);for(;!i.isConsumed();){let n=i.readUnsignedInt32(),s=i.skip(12).readUnsignedInt32(),d=1===i.skip(4).readUnsignedInt32(),o=i.skip(4).read(4).toString("hex"),p=i.read(4).toString("hex"),f=`${[String(a.length).padStart(4,"0"),o.toUpperCase().padStart(8,"0"),p.toUpperCase().padStart(8,"0")].join("_")}.koei`,u=r.subarray(n,n+s);if(!d){a.push({name:f,data:u});continue}let g=new t(u),l=g.skip(4).readUnsignedInt32();g.skip(4);let h=[];for(let e=0;e<l;e++)h.push(g.readUnsignedInt32());g.skipPadding(128);let k=[];for(let t=0;t<l;t++){let r=g.read(h[t]),n=120===r.at(4);k.push(n?e(r.subarray(4)):r),g.skipPadding(128)}a.push({name:f,data:Buffer.concat(k)})}return a}