import{BufferConsumer as e}from"@triforce-heroes/triforce-core/BufferConsumer";import{inflate as r}from"pako";export function getEntries(t,n){let a=[],i=new e(n);for(;!i.isConsumed();){let n=i.readUnsignedInt32(),s=i.skip(12).readUnsignedInt32(),o=1===i.skip(4).readUnsignedInt32(),d=i.skip(4).read(4).toString("hex"),p=i.read(4).toString("hex"),f=String(a.length).padStart(4,"0"),h=d.toUpperCase().padStart(8,"0"),u=p.toUpperCase().padStart(8,"0"),g=`${[f,h,u].join("_")}.koei`,m=t.subarray(n,n+s);if(!o){a.push({index:f,name:g,hash:h,hashSub:u,data:m});continue}let k=new e(m),l=k.skip(4).readUnsignedInt32();k.skip(4);let S=[];for(let e=0;e<l;e++)S.push(k.readUnsignedInt32());k.skipPadding(128);let U=[];for(let e=0;e<l;e++){let t=k.read(S[e]);120===t.at(4)?U.push(Buffer.from(r(Uint8Array.from(t.subarray(4))))):U.push(t),k.skipPadding(128)}a.push({index:f,name:g,hash:h,hashSub:u,data:Buffer.concat(U)})}return a}