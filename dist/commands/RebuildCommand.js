import{existsSync as o,readFileSync as r,readdirSync as e,writeFileSync as t}from"node:fs";import{join as i}from"node:path";import{fatal as m}from"@triforce-heroes/triforce-core/Console";import{normalize as f}from"@triforce-heroes/triforce-core/Path";import{rebuild as n}from"../Rebuilder.js";export function RebuildCommand(s,c,d){o(s)||m(`Directory not found: ${c}`),process.stdout.write(`Rebuilding ${f(c)} to ${c} and ${d}... `);let p=Date.now(),{indexes:a,blocks:u}=n(Object.fromEntries(e(s).map(o=>[o,r(i(s,o))])));t(d,a),t(c,u),process.stdout.write(`OK (${((Date.now()-p)/1e3).toFixed(2)}s)
`)}